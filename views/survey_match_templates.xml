<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Define a standalone template for match following questions -->
    <template id="match_following_question_template">
        <div class="js_match_following match_following_container" t-att-data-question-id="question.id">
            <div class="row">
                <div class="col-md-6">
                    <h5>Items</h5>
                    <div class="o_match_questions">
                        <t t-foreach="question.match_following_pairs" t-as="pair">
                            <div class="o_match_item" t-att-data-pair-id="pair.id" t-att-data-score="pair.score">
                                <span t-esc="pair.left_option"/>
                            </div>
                        </t>
                    </div>
                </div>
                <div class="col-md-6">
                    <h5>Match With</h5>
                    <div class="o_match_answers">
                        <t t-foreach="question.match_following_pairs" t-as="pair">
                            <div class="o_match_item" t-att-data-pair-id="pair.id" t-att-data-score="pair.score">
                                <span t-esc="pair.right_option"/>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
            <input type="hidden" t-att-name="'question_' + str(question.id)" value="[]"/>
        </div>
    </template>
    
    <!-- Add CSS for match following directly into survey layout -->
    <template id="survey_layout_extend" inherit_id="survey.layout">
        <xpath expr="//head" position="inside">
            <style>
                .match_following_container { padding: 15px; background-color: #f8f9fa; border-radius: 4px; margin-bottom: 20px; }
                .o_match_questions, .o_match_answers { min-height: 150px; border: 1px dashed #ccc; padding: 10px; border-radius: 4px; background-color: #fff; }
                .o_match_item { background-color: #fff; border: 1px solid #dee2e6; padding: 10px; margin: 5px 0; border-radius: 4px; cursor: move; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
                .o_match_item.dragging { opacity: 0.5; }
                .o_match_item.matched { background-color: #d4edda; border-color: #c3e6cb; }
                .drop-zone-active { background-color: #e8f4ff; border-color: #b8daff; }
            </style>
            <script type="text/javascript" src="/custom_elearn/static/src/js/survey_match_following.js"></script>
        </xpath>
    </template>
    
    <!-- Add a demo route to test match following questions -->
    <template id="survey_demo_page">
        <t t-call="website.layout">
            <div class="container mt-4">
                <h1>Match Following Demo</h1>
                <div class="card">
                    <div class="card-body">
                        <t t-if="question">
                            <h3 t-esc="question.title"/>
                            <t t-call="custom_elearn.match_following_question_template"/>
                        </t>
                        <t t-else="">
                            <div class="alert alert-info">No match following questions found.</div>
                        </t>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>
