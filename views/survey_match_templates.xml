<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Define a simple template for match following questions -->
    <template id="match_following_question_template">
        <div class="js_match_following match_following_container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Items</h5>
                    <div class="o_match_questions">
                        <!-- Placeholder for left options -->
                        <div class="o_match_item">Option 1</div>
                        <div class="o_match_item">Option 2</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <h5>Match With</h5>
                    <div class="o_match_answers">
                        <!-- Placeholder for right options -->
                        <div class="o_match_item">Answer 1</div>
                        <div class="o_match_item">Answer 2</div>
                    </div>
                </div>
            </div>
            <input type="hidden" name="match_following_result" value="[]"/>
        </div>
    </template>
    
    <!-- Add CSS for match following directly into survey layout -->
    <template id="survey_layout_extend" inherit_id="survey.layout">
        <xpath expr="//head" position="inside">
            <style>
                .match_following_container { padding: 15px; background-color: #f8f9fa; border-radius: 4px; margin-bottom: 20px; }
                .o_match_questions, .o_match_answers { min-height: 150px; border: 1px dashed #ccc; padding: 10px; border-radius: 4px; background-color: #fff; }
                .o_match_item { background-color: #fff; border: 1px solid #dee2e6; padding: 10px; margin: 5px 0; border-radius: 4px; cursor: move; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
                .o_match_item.dragging { opacity: 0.5; }
                .o_match_item.matched { background-color: #d4edda; border-color: #c3e6cb; }
                .drop-zone-active { background-color: #e8f4ff; border-color: #b8daff; }
            </style>
            
            <script type="text/javascript">
                // Simple script to initialize drag and drop
                document.addEventListener('DOMContentLoaded', function() {
                    // Find containers
                    var containers = document.querySelectorAll('.match_following_container');
                    if (containers.length === 0) return;
                    
                    // Initialize each container
                    containers.forEach(function(container) {
                        // Make items draggable
                        var items = container.querySelectorAll('.o_match_item');
                        items.forEach(function(item) {
                            item.setAttribute('draggable', true);
                            
                            item.addEventListener('dragstart', function(e) {
                                e.dataTransfer.setData('text', this.textContent);
                                this.classList.add('dragging');
                            });
                            
                            item.addEventListener('dragend', function() {
                                this.classList.remove('dragging');
                            });
                        });
                        
                        // Set up drop zones
                        var zones = container.querySelectorAll('.o_match_questions, .o_match_answers');
                        zones.forEach(function(zone) {
                            zone.addEventListener('dragover', function(e) {
                                e.preventDefault();
                                this.classList.add('drop-zone-active');
                            });
                            
                            zone.addEventListener('dragleave', function() {
                                this.classList.remove('drop-zone-active');
                            });
                            
                            zone.addEventListener('drop', function(e) {
                                e.preventDefault();
                                var text = e.dataTransfer.getData('text');
                                var draggedItem = document.querySelector('.dragging');
                                
                                if (draggedItem) {
                                    draggedItem.classList.add('matched');
                                    draggedItem.classList.remove('dragging');
                                }
                                
                                this.classList.remove('drop-zone-active');
                            });
                        });
                    });
                });
            </script>
        </xpath>
    </template>
</odoo>
